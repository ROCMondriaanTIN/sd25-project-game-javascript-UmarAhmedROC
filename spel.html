<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Minesweeper - eenvoudig</title>
<style>
  /* Eenvoudige, schone styling */
  :root {
    --size: 10;      /* standaard bordgrootte */
    --cell: 34px;    /* grootte van een cel */
    --gap: 4px;
  }
  body{
    font-family: system-ui, Arial, sans-serif;
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg,#081028,#04101a);
    color:#e6eef8;
  }
  .app {
    width: calc(var(--cell) * var(--size) + var(--gap) * (var(--size) - 1));
    text-align:center;
  }
  h1 { margin: 8px 0 12px; font-size:18px; color:#dff; }
  .controls { display:flex; justify-content:space-between; gap:8px; margin-bottom:10px; align-items:center; }
  select,input,button { padding:6px 8px; border-radius:6px; border:0; font-size:14px; }
  #board {
    display:grid;
    grid-template-columns: repeat(var(--size), var(--cell));
    gap: var(--gap);
    padding: var(--gap);
    background:#07122a;
    border-radius:10px;
    box-shadow: 0 6px 30px rgba(0,0,0,0.6);
  }
  .cell {
    width:var(--cell); height:var(--cell);
    display:flex; align-items:center; justify-content:center;
    background:#bcd3ef11;
    border-radius:6px;
    cursor:pointer;
    user-select:none;
    font-weight:700;
    color:#00112a;
    font-size:14px;
    position:relative;
  }
  .cell.revealed {
    background: linear-gradient(180deg,#f3f9ff,#dfeefc);
    cursor:default;
    box-shadow: inset 0 -2px 0 rgba(0,0,0,0.06);
  }
  .cell.bomb {
    background: linear-gradient(180deg,#ff7a7a,#ff3b3b);
    color:#210000;
  }
  .flag { font-size:14px; position:absolute; top:3px; right:4px; }
  .info { display:flex; justify-content:space-between; margin:8px 0 12px; font-size:14px; }
  .message { margin-top:10px; font-weight:600; }
  .number-1 { color:#0b57ff; }
  .number-2 { color:#0bbf3e; }
  .number-3 { color:#ff5a00; }
  .number-4 { color:#8b2cff; }
</style>
</head>
<body>
  <div class="app" id="app">
    <h1>Minesweeper â€” Eenvoudig</h1>

    <div class="controls">
      <div>
        Grootte: 10x10
        Bommen:
        <input id="bombInput" type="number" min="1" value="15" style="width:64px"/>
      </div>
      <div>
        <button id="resetBtn">Reset</button>
      </div>
    </div>

    <div class="info">
      <div>Bommen over: <span id="bombsLeft">0</span></div>
      <div>Tijd: <span id="timer">0</span>s</div>
    </div>

    <div id="board" role="grid" aria-label="Mijnenbord"></div>

    <div class="message" id="message"></div>
    <div style="margin-top:8px; font-size:13px; color:#bcd3ef99">
      Rechtsklik = vlag. Eerste klik is veilig.
    </div>
  </div>

<script>
/*
  Simpele Minesweeper
  - Linksklik: onthullen
  - Rechtsklik: vlag toggelen
  - Eerste klik: bommen worden geplaatst met beveiligde omgeving rond die klik
  - Flood-fill (iteratief) voor lege gebieden
*/

const boardEl = document.getElementById('board');
const bombsLeftEl = document.getElementById('bombsLeft');
const timerEl = document.getElementById('timer');
const messageEl = document.getElementById('message');
const resetBtn = document.getElementById('resetBtn');
const bombInput = document.getElementById('bombInput');

let size = 10;
let totalCells = size * size;
let totalBombs = Number(bombInput.value);
let cells = [];        // array met cell-objecten
let started = false;
let timer = null;
let seconds = 0;
let bombsLeft = totalBombs;
let gameOver = false;

function resetBoard(){
  // init waarden
  size = 10;
  totalCells = size * size;
  totalBombs = Math.min(Number(bombInput.value), totalCells - 1);
  bombsLeft = totalBombs;
  bombsLeftEl.textContent = bombsLeft;
  boardEl.style.setProperty('--size', size);
  boardEl.innerHTML = '';
  cells = [];
  started = false;
  seconds = 0;
  timerEl.textContent = '0';
  messageEl.textContent = '';
  clearInterval(timer);
  gameOver = false;

  // maak cellen en DOM elementen
  for (let i = 0; i < totalCells; i++){
    const el = document.createElement('div');
    el.className = 'cell';
    el.dataset.index = i;
    el.tabIndex = 0;
    boardEl.appendChild(el);

    const c = {
      el: el,
      index: i,
      isBomb: false,
      revealed: false,
      flagged: false,
      bombsAround: 0,
      neighbors: []
    };
    cells.push(c);

    // events
    el.addEventListener('click', (e) => handleLeftClick(e, c));
    el.addEventListener('contextmenu', (e) => { e.preventDefault(); handleRightClick(e, c); });
    el.addEventListener('keydown', (e) => {
      // toegankelijkheid: Enter openen, space vlag
      if (e.key === 'Enter') handleLeftClick(e, c);
      if (e.key === ' ') { e.preventDefault(); handleRightClick(e, c); }
    });
  }

  // bereken buren voor elke cel
  for (let i = 0; i < totalCells; i++){
    cells[i].neighbors = getNeighbors(i);
  }
}

function placeBombs(firstIndex){
  // zorg dat de eerste klik en diens buren veilig zijn
  const safe = new Set([firstIndex, ...cells[firstIndex].neighbors]);
  let placed = 0;
  while (placed < totalBombs){
    const r = Math.floor(Math.random() * totalCells);
    if (safe.has(r) || cells[r].isBomb) continue;
    cells[r].isBomb = true;
    placed++;
  }
  // vul bombsAround per cel
  for (let c of cells){
    let count = 0;
    for (let n of c.neighbors) if (cells[n].isBomb) count++;
    c.bombsAround = count;
  }
}

function startTimer(){
  timer = setInterval(() => {
    seconds++;
    timerEl.textContent = seconds;
  }, 1000);
}

function handleLeftClick(e, cell){
  if (gameOver) return;
  if (!started){
    // eerste klik: plaats bommen en start timer
    placeBombs(cell.index);
    started = true;
    startTimer();
  }
  if (cell.flagged || cell.revealed) return;
  reveal(cell.index);
  checkWin();
}

function handleRightClick(e, cell){
  if (gameOver || cell.revealed) return;
  cell.flagged = !cell.flagged;
  cell.el.innerHTML = cell.flagged ? '<span class="flag">ðŸš©</span>' : '';
  bombsLeft += cell.flagged ? -1 : 1;
  bombsLeftEl.textContent = bombsLeft;
}

function reveal(index){
  // bescherm tegen dubbele reveals
  if (cells[index].revealed || cells[index].flagged) return;

  // als bom: eindig spel
  if (cells[index].isBomb){
    cells[index].revealed = true;
    cells[index].el.classList.add('revealed', 'bomb');
    cells[index].el.textContent = 'ðŸ’£';
    endGame(false);
    return;
  }

  // iteratieve flood-fill: stack
  const stack = [index];
  while (stack.length){
    const i = stack.pop();
    const c = cells[i];
    if (c.revealed || c.flagged) continue;
    c.revealed = true;
    c.el.classList.add('revealed');

    if (c.bombsAround > 0){
      // toon aantal naastliggende bommen
      c.el.textContent = c.bombsAround;
      c.el.classList.add('number-' + c.bombsAround);
    } else {
      c.el.textContent = '';
      // voeg buren toe om verder te onthullen
      for (let n of c.neighbors){
        if (!cells[n].revealed && !cells[n].isBomb) stack.push(n);
      }
    }
  }
}

function getNeighbors(index){
  const x = index % size;
  const y = Math.floor(index / size);
  const arr = [];
  for (let dy = -1; dy <= 1; dy++){
    for (let dx = -1; dx <= 1; dx++){
      if (dx === 0 && dy === 0) continue;
      const nx = x + dx;
      const ny = y + dy;
      if (nx >= 0 && nx < size && ny >= 0 && ny < size){
        arr.push(ny * size + nx);
      }
    }
  }
  return arr;
}

function endGame(won){
  gameOver = true;
  clearInterval(timer);
  started = false;

  // onthul alle bommen
  for (let c of cells){
    if (c.isBomb){
      c.el.classList.add('revealed', 'bomb');
      if (!c.revealed) c.el.textContent = 'ðŸ’£';
    }
  }

  messageEl.textContent = won ? 'Gefeliciteerd! Je hebt gewonnen.' : 'Game over â€” je bent ontploft.';
}

function checkWin(){
  // win als alle niet-bomb cellen onthuld zijn
  const left = cells.filter(c => !c.revealed && !c.isBomb).length;
  if (left === 0){
    endGame(true);
  }
}

// events UI
resetBtn.addEventListener('click', resetBoard);
bombInput.addEventListener('change', resetBoard);

// start
resetBoard();
</script>
</body>
</html>
